1
00:00:00,170 --> 00:00:02,810
So let's go ahead and practice S3 access logs.

2
00:00:02,810 --> 00:00:07,910
And for this I'm going to create an S3 access logs, define V3 buckets.

3
00:00:07,970 --> 00:00:12,020
And then I will go ahead and create that bucket.

4
00:00:12,140 --> 00:00:14,810
So that bucket is going to be our logging bucket.

5
00:00:14,810 --> 00:00:16,850
And I'm going to keep this open here.

6
00:00:16,850 --> 00:00:21,920
And in another tab I'm going to take one of my buckets that I've created.

7
00:00:21,920 --> 00:00:26,060
And then I'm going to enable the um logging.

8
00:00:26,060 --> 00:00:27,380
So I just took one bucket.

9
00:00:27,380 --> 00:00:34,160
But whatever bucket you want for your really I will go on properties and then I will scroll down and

10
00:00:34,160 --> 00:00:37,070
look for server access logging.

11
00:00:37,070 --> 00:00:38,480
So we edit it.

12
00:00:38,480 --> 00:00:40,400
So let's enable it.

13
00:00:40,400 --> 00:00:46,910
And as you can see the bucket policy will be updated for the target buckets where we want to write data.

14
00:00:46,910 --> 00:00:49,700
So first we have to specify a destination.

15
00:00:49,700 --> 00:00:50,690
So oops.

16
00:00:50,690 --> 00:00:53,660
So I'm going to go in my bucket and type access.

17
00:00:53,660 --> 00:00:55,940
So Stefan access log v3.

18
00:00:55,940 --> 00:00:56,840
This is the bucket I want.

19
00:00:56,840 --> 00:00:59,330
And I will choose this as my destination.

20
00:00:59,510 --> 00:01:01,550
Then we have a destination region.

21
00:01:01,550 --> 00:01:03,560
So this is EU West one.

22
00:01:03,560 --> 00:01:05,930
We have the destination bucket name prefix.

23
00:01:05,930 --> 00:01:11,690
This is if I wanted to select an optional prefix in my bucket to for example have slash logs, but we

24
00:01:11,690 --> 00:01:12,800
will not do this.

25
00:01:12,920 --> 00:01:15,830
And then the log object key format.

26
00:01:15,830 --> 00:01:17,900
So we have this format right here.

27
00:01:17,900 --> 00:01:22,490
And there is an example here given to me as the log key example.

28
00:01:22,490 --> 00:01:30,050
Or if I use the second one, I can also specify a different S3 event time or a log file delivery time.

29
00:01:30,050 --> 00:01:34,730
And again this would change my final uh key format.

30
00:01:34,730 --> 00:01:36,230
Right now we're going to keep it as default.

31
00:01:36,230 --> 00:01:38,330
So let's just use the first option okay.

32
00:01:38,330 --> 00:01:39,710
Which will be enough for our use case.

33
00:01:39,710 --> 00:01:41,990
And then click on Save changes.

34
00:01:42,540 --> 00:01:44,610
And now my S3.

35
00:01:45,470 --> 00:01:48,230
Uh, server access logging is enabled.

36
00:01:48,230 --> 00:01:54,710
So now what I can do is I can go to my objects, I can click on this one, I can maybe open it, um,

37
00:01:54,710 --> 00:01:58,190
back into my bucket, I can go in it and I can upload a file.

38
00:01:58,190 --> 00:02:01,400
So I'll add a file and it'll be, for example, my JPEG.

39
00:02:01,400 --> 00:02:04,250
So you can do a lot of things in your bucket.

40
00:02:04,250 --> 00:02:07,400
And all of this is going to generate activity.

41
00:02:07,400 --> 00:02:12,080
And this activity is going to be logged into your logging bucket.

42
00:02:12,110 --> 00:02:15,170
Now if I refresh, as you can see nothing happens yet.

43
00:02:15,170 --> 00:02:21,620
That's because it takes a little bit of time for your access logs to go into your logging buckets.

44
00:02:21,620 --> 00:02:25,100
But what we can do in the meantime is have a look at the permissions.

45
00:02:25,100 --> 00:02:29,690
Because when we enabled the server bucket.

46
00:02:29,690 --> 00:02:32,150
So we were right here the server access logging.

47
00:02:32,150 --> 00:02:36,650
When we enabled it, it was saying that the bucket policy will be updated.

48
00:02:36,650 --> 00:02:39,050
So let's verify that we can scroll down.

49
00:02:39,050 --> 00:02:41,210
And we have the bucket policy right here.

50
00:02:41,210 --> 00:02:49,970
And indeed yes, the bucket policy was updated to allow the logging service of Amazon S3 to put objects

51
00:02:49,970 --> 00:02:52,130
into this buckets.

52
00:02:52,610 --> 00:02:53,600
So this is pretty good.

53
00:02:53,600 --> 00:02:59,330
So this, um, not what we have to do is go back into our buckets and wait for the first logs to be

54
00:02:59,330 --> 00:02:59,900
sent.

55
00:02:59,900 --> 00:03:02,330
So it took a couple of hours, but I just refreshed.

56
00:03:02,330 --> 00:03:09,230
And in my bucket I see a lot of files now objects and these have been created directly for my access

57
00:03:09,230 --> 00:03:09,470
log.

58
00:03:09,470 --> 00:03:12,920
So I can click on one of them and I can open it for example.

59
00:03:12,920 --> 00:03:15,680
And in here I'm able to see, well what happened.

60
00:03:15,680 --> 00:03:18,200
And this is quite hard to decipher okay.

61
00:03:18,200 --> 00:03:24,350
But it gives you the API call, the success rate, who accessed it, what bucket it was, at what time,

62
00:03:24,350 --> 00:03:26,150
and a lot of information.

63
00:03:26,150 --> 00:03:29,630
So okay, that's it for S3 access logs.

64
00:03:29,630 --> 00:03:32,630
I hope you liked it and I will see you in the next lecture.


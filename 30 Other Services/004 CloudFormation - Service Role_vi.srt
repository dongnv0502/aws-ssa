1
00:00:00,240 --> 00:00:01,890
Vì vậy đây là một điều bạn cần

2
00:00:01,890 --> 00:00:04,980
biết về CloudFormation và bảo mật.

3
00:00:04,980 --> 00:00:07,860
CloudFormation có thể sử dụng service role.

4
00:00:07,860 --> 00:00:08,693
Chúng là gì?

5
00:00:08,693 --> 00:00:11,160
Chúng là các IAM role mà bạn tạo

6
00:00:11,160 --> 00:00:13,830
và dành riêng cho CloudFormation

7
00:00:13,830 --> 00:00:15,210
cho phép CloudFormation

8
00:00:15,210 --> 00:00:16,530
thực sự tạo, cập nhật

9
00:00:16,530 --> 00:00:19,500
và xóa tài nguyên stack thay cho bạn.

10
00:00:19,500 --> 00:00:22,620
Vì vậy nếu bạn muốn cho phép người dùng

11
00:00:22,620 --> 00:00:23,940
thực sự tạo, cập nhật

12
00:00:23,940 --> 00:00:25,530
và xóa tài nguyên stack,

13
00:00:25,530 --> 00:00:26,940
nhưng họ không có quyền

14
00:00:26,940 --> 00:00:29,160
làm việc trực tiếp với các tài nguyên,

15
00:00:29,160 --> 00:00:31,140
bạn sẽ sử dụng một service role.

16
00:00:31,140 --> 00:00:33,240
Ví dụ, chúng ta định nghĩa một template

17
00:00:33,240 --> 00:00:36,019
và quyền IAM của chính chúng ta với tư cách người dùng là

18
00:00:36,019 --> 00:00:39,120
thực hiện hành động trên CloudFormation.

19
00:00:39,120 --> 00:00:41,520
Và chúng ta có quyền IAM PassRole.

20
00:00:41,520 --> 00:00:44,190
Chúng ta cũng tạo một service role mà chúng ta sẽ

21
00:00:44,190 --> 00:00:46,590
dành cho CloudFormation.

22
00:00:46,590 --> 00:00:50,220
Và service role này có quyền S3 sao đối với bucket,

23
00:00:50,220 --> 00:00:51,090
ví dụ như quyền

24
00:00:51,090 --> 00:00:53,880
tạo, cập nhật và xóa một bucket.

25
00:00:53,880 --> 00:00:56,236
Vì vậy CloudFormation ở đây sẽ có thể

26
00:00:56,236 --> 00:00:59,160
tạo S3 bucket này nhờ

27
00:00:59,160 --> 00:01:02,010
service role của nó vì người dùng có thể

28
00:01:02,010 --> 00:01:05,099
chuyển role đó cho CloudFormation.

29
00:01:05,099 --> 00:01:07,890
Trường hợp sử dụng cho bảo mật là nếu bạn muốn

30
00:01:07,890 --> 00:01:10,245
đạt được nguyên tắc đặc quyền tối thiểu

31
00:01:10,245 --> 00:01:12,990
và bạn không muốn cấp cho người dùng

32
00:01:12,990 --> 00:01:13,890
tất cả quyền

33
00:01:13,890 --> 00:01:15,420
để tạo các tài nguyên stack,

34
00:01:15,420 --> 00:01:16,680
chỉ quyền

35
00:01:16,680 --> 00:01:19,920
để gọi một service role trên CloudFormation.

36
00:01:19,920 --> 00:01:22,087
Để việc này hoạt động, hãy nhớ người dùng

37
00:01:22,087 --> 00:01:26,280
phải có quyền tên là iam PassRole,

38
00:01:26,280 --> 00:01:28,140
đây là quyền cần thiết

39
00:01:28,140 --> 00:01:32,970
để trao một role cho dịch vụ cụ thể trong AWS.

40
00:01:32,970 --> 00:01:34,290
Hãy để tôi cho bạn ví dụ

41
00:01:34,290 --> 00:01:36,870
về IAM role với CloudFormation.

42
00:01:36,870 --> 00:01:40,260
Vì vậy nếu bạn vào IAM rồi đi

43
00:01:40,260 --> 00:01:42,780
đến phần Roles trong IAM,

44
00:01:42,780 --> 00:01:44,310
chúng ta sẽ tạo một role

45
00:01:44,310 --> 00:01:47,010
và đó là cho một dịch vụ AWS,

46
00:01:47,010 --> 00:01:49,893
dịch vụ đó là CloudFormation.

47
00:01:51,390 --> 00:01:55,140
Tiếp theo, đối với permission policy,

48
00:01:55,140 --> 00:01:58,230
tôi sẽ cấp quyền S3 full access

49
00:01:58,230 --> 00:02:00,540
để có một role dành riêng cho Amazon S3,

50
00:02:00,540 --> 00:02:01,653
chỉ như một ví dụ.

51
00:02:02,880 --> 00:02:03,990
Bấm Next và tôi sẽ đặt tên

52
00:02:03,990 --> 00:02:08,990
là DemoRole for CFN with S3 capabilities.

53
00:02:11,910 --> 00:02:14,040
Và role này cho phép CloudFormation

54
00:02:14,040 --> 00:02:16,980
làm mọi thứ với Amazon S3.

55
00:02:16,980 --> 00:02:18,663
Vì vậy role này đã được tạo.

56
00:02:19,620 --> 00:02:21,960
Bây giờ nếu tôi vào CloudFormation

57
00:02:21,960 --> 00:02:24,540
và tạo một stack, tôi sẽ dùng một

58
00:02:24,540 --> 00:02:25,740
template có sẵn của tôi.

59
00:02:25,740 --> 00:02:27,960
Tôi không cần gì quá phức tạp.

60
00:02:27,960 --> 00:02:30,090
Chúng ta sẽ không đi hết quy trình.

61
00:02:30,090 --> 00:02:32,410
Vì vậy tôi đặt tên cái này là DemoRole.

62
00:02:32,410 --> 00:02:34,440
Bấm Next.

63
00:02:34,440 --> 00:02:35,580
Và như bạn thấy ở đây,

64
00:02:35,580 --> 00:02:38,220
trong phần Permissions có một IAM role.

65
00:02:38,220 --> 00:02:39,390
Điều này là tùy chọn.

66
00:02:39,390 --> 00:02:41,370
Nếu tôi không chỉ định, IAM role sẽ

67
00:02:41,370 --> 00:02:43,590
sử dụng quyền cá nhân của tôi.

68
00:02:43,590 --> 00:02:46,260
Nhưng nếu tôi muốn chỉ định một IAM role,

69
00:02:46,260 --> 00:02:48,407
tôi có thể chọn DemoRole này

70
00:02:48,407 --> 00:02:50,910
cho CFN với khả năng S3.

71
00:02:50,910 --> 00:02:52,830
Và role này sẽ được sử dụng

72
00:02:52,830 --> 00:02:55,290
cho mọi thao tác trên stack.

73
00:02:55,290 --> 00:02:58,260
Điều đó có nghĩa là role bây giờ

74
00:02:58,260 --> 00:02:59,820
sẽ không dùng quyền cá nhân của tôi,

75
00:02:59,820 --> 00:03:02,460
mà dùng role này, và vì role này

76
00:03:02,460 --> 00:03:06,750
chỉ có quyền Amazon S3,

77
00:03:06,750 --> 00:03:08,250
nên thực tế stack của tôi sẽ thất bại

78
00:03:08,250 --> 00:03:09,330
vì stack của tôi thực sự

79
00:03:09,330 --> 00:03:11,160
tạo một EC2 instance.

80
00:03:11,160 --> 00:03:13,380
Nhưng đây là nơi các quyền

81
00:03:13,380 --> 00:03:14,370
được định nghĩa nếu bạn muốn

82
00:03:14,370 --> 00:03:17,040
sử dụng IAM role cho CloudFormation.

83
00:03:17,040 --> 00:03:18,060
Và đó là tất cả.

84
00:03:18,060 --> 00:03:20,340
Hy vọng bạn thích bài này và hẹn gặp bạn

85
00:03:20,340 --> 00:03:21,423
ở bài giảng tiếp theo.


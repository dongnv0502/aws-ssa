1
00:00:00,000 --> 00:00:00,833
Tiếp theo là một số khái niệm nâng cao cho load balancer.

2
00:00:00,833 --> 00:00:04,440
Đầu tiên: network security.

3
00:00:04,440 --> 00:00:07,110
Hiện tại ta truy cập load balancer qua security group

4
00:00:07,110 --> 00:00:10,680
của chính nó, và EC2 qua security group riêng.

5
00:00:10,680 --> 00:00:13,320
Nếu mở IP public của EC2, ta truy cập trực tiếp được;

6
00:00:13,320 --> 00:00:15,570
tất nhiên cũng truy cập qua load balancer được.

7
00:00:15,570 --> 00:00:18,120
Nhưng tốt hơn là chỉ cho truy cập EC2

8
00:00:18,120 --> 00:00:20,100
thông qua load balancer.

9
00:00:20,100 --> 00:00:22,860
Làm sao? Vào Security Groups -> launch-wizard-1,

10
00:00:22,860 --> 00:00:26,220
chỉnh Inbound rules: hiện tại HTTP cho phép từ mọi nơi.

11
00:00:26,220 --> 00:00:30,870
Xóa rule này, thêm rule mới HTTP nhưng Source là

12
00:00:30,870 --> 00:00:35,340
security group của load balancer (chọn theo tên).

13
00:00:35,340 --> 00:00:36,720
Lưu lại.

14
00:00:36,720 --> 00:00:37,950
Kết quả: truy cập thẳng EC2

15
00:00:37,950 --> 00:00:41,310
bằng IP public sẽ timeout (bị chặn),

16
00:00:41,310 --> 00:00:42,143
nhưng qua load balancer thì vẫn được

17
00:00:43,830 --> 00:00:44,670
vì security group của EC2

18
00:00:44,670 --> 00:00:47,550
cho inbound từ security group của ALB.

19
00:00:47,550 --> 00:00:51,600
Thứ hai: listener rules của Application Load Balancer.

20
00:00:51,600 --> 00:00:53,430
Vào ALB -> Listeners.

21
00:00:53,430 --> 00:00:56,610
Mặc định: mọi request gửi tới demo target group.

22
00:00:56,610 --> 00:00:58,410
Ta có thể thêm rule mới (DemoRule).

23
00:00:58,410 --> 00:01:01,440
Thêm điều kiện (Conditions):

24
00:01:01,440 --> 00:01:04,050
- Host header (ví dụ *.example.com, myapp.example.com)

25
00:01:04,050 --> 00:01:06,420
- Path (ví dụ /error)

26
00:01:06,420 --> 00:01:09,450
- HTTP method (GET/POST), Source IP,

27
00:01:09,450 --> 00:01:12,540
- Query string, HTTP header.

28
00:01:12,540 --> 00:01:15,090
Ở đây dùng Path = /error.

29
00:01:15,090 --> 00:01:18,870
Hành động (Action): có thể Forward, Redirect hoặc Fixed response.

30
00:01:18,870 --> 00:01:22,530
Ta chọn Fixed response: status 404, body “not found, custom error”.

31
00:01:22,530 --> 00:01:25,050
Ưu tiên (Priority): số nhỏ ưu tiên cao hơn; chọn 5.

32
00:01:25,050 --> 00:01:28,140
Tạo rule: giờ có Default rule và DemoRule.

33
00:01:28,140 --> 00:01:31,080
Kiểm thử: copy DNS name của ALB, thêm /error.

34
00:01:31,080 --> 00:01:33,120
Kết quả: trả về “not found, custom error” (404),

35
00:01:33,120 --> 00:01:36,960
đúng với rule đã cấu hình cho đường dẫn /error.

36
00:01:36,960 --> 00:01:38,040
Xong, hẹn gặp ở bài sau.

